<table class="table">
  <thead>
    <tr>
      <th>Activity</th>
      <% if user_signed_in? %>
        <th>Proximity</th>
      <% end %>
      <th>When</th>
      <th>Rating</th>
      <th>Spots</th>
      <th>Where</th>
      <th>Price</th>
      <th>Host</th>
      <% if user_signed_in? %>
        <th></th>
      <% end %>
    </tr>
  </thead>

  <tbody>
  <% events.each do |event| %>
    <tr>
      <td><div class="title-top"><%= link_to event.title, event %></div><div class="title-bot"><%= truncate(event.description, :length => 90, :separator => ' ') %></div></td>
      <% if user_signed_in? %>
        <td><%= "#{current_user.distance_to(event.venue)} mi" unless event.venue.blank? %></td>
      <% end %>
      <td><div class="index-date-column"><%= event.start_time.to_date.strftime("%A %b #{event.start_time.day.ordinalize}") %><br><%= l event.start_time.to_time, format: :short_time %> - <%= l event.end_time.to_time, format: :short_time %><br/><span class="muted" data-livestamp="<%= event.start_time %>"></span></div></td>
      <td></td>
      <td><%= render :partial => 'events/attends_meter', :locals => { :event => event } %></td>
      <td><%= event.venue.blank? ? 'TBD' : link_to(event.venue.name, event.venue) %></td>
      <td><%= event_price(event) %></td>
      <td>
        <% if event.host %>
          <%= contextualized_user_link event.host %><br/><span class="muted"><%= pluralize(event.host.hostings.count, 'activity') %> - <%= event.host.rating_as_host %></span>
        <% end %>
      </td>
      <% if user_signed_in? %>
        <td><%= render :partial => 'events/status_wrt_current_user', :locals => {:event => event} %></td>
      <% end %>
    </tr>
  <% end %>
  </tbody>
</table>
